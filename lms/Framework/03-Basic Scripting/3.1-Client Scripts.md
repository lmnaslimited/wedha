#  Client Scripts

**Client Script** in LENS is a JavaScript-based script that runs on the client-side (browser) and is used to manipulate or modify the behavior of forms, fields, or interactions within the LENS system.

- **Client-side scripting**: Client scripts are executed on the user's browser rather than the server.
- **Purpose**: They are used to add custom behavior to forms, such as auto-filling fields, performing validations, showing/hiding fields, or creating dependencies between fields.
-   **Languages:** JavaScript (often using LENS built-in methods and APIs).

### Why Client Scripts in LENS?

-   **Customization**: Client Scripts allow you to tailor LENS behavior without altering the core code.
-   **User Interaction**: These scripts help improve the user experience by automating repetitive tasks, validating inputs, or guiding users based on certain conditions.

#### Client-Side vs Server-Side Scripting

-   **Client-side scripts** (like Client Scripts) are executed in the user’s browser.
-   **Server-side scripts** are executed on the server, controlling more back-end operations.

#### **1. Accessing Client Scripts**

   **Navigate to Client Scripts:**
   
 - Go to the LENS Desk.
       
 - Open the module where you want to create or edit a Client Script.
           
 - Select "Client Script" from the module list or use the
   search bar.

 **Creating a New Client Script:**
    
    
 - Click on “New” to create a new Client Script.

    

 - Choose the **DocType** you want to apply the script to (e.g., Sales
   Invoice).

 - Set the **Script Type** (e.g., JavaScript).

#### **2. Common Events:**
    
  **onload**: Triggered when the form is loaded.
**refresh** : Triggered when the form is refreshed.
**validate**: Triggered before the form is saved
**change**: Triggered when a field value changes.
**submit**: Triggered before the form is submitted.



////////////////////////////////////////////////////////////////////





----------

### 2. **How to Create a Client Script in ERPNext**

#### Step 1: Navigate to the Client Script Section

To create a Client Script:

-   Go to the **ERPNext Dashboard**.
-   Search for **Client Script** in the search bar and click to open it.
-   Click on **New** to create a new Client Script.

#### Step 2: Fill Out the Basic Information

-   **Doctype**: Select the Doctype (form) for which the script will apply.
-   **Type**: Choose the trigger (events like 'onload', 'validate', 'refresh', etc.).
-   **Script**: This is where the actual JavaScript code is written.

#### Step 3: Understanding the Components

-   **Doctype**: The specific form where the script will apply.
-   **Trigger Event**: Events like `validate`, `refresh`, `onload` that determine when the script will run.
-   **JavaScript Code**: The logic that defines the custom behavior (fields manipulation, validation, etc.).

----------

### 3. **Basic Client Script Examples**

#### Example 1: Auto-Fill Field Based on Another Field

// When 'customer' is selected, auto-fill the 'customer_name' field
frappe.ui.form.on('Sales Order', {
    customer: function(frm) {
        if (frm.doc.customer) {
            frappe.db.get_value('Customer', frm.doc.customer, 'customer_name', (r) => {
                frm.set_value('customer_name', r.customer_name);
            });
        }
    }
});

Example 2: Form Validation Before Saving
// Prevent save if the total amount is zero
frappe.ui.form.on('Sales Invoice', {
    validate: function(frm) {
        if (frm.doc.total === 0) {
            frappe.throw('Total cannot be zero.');
        }
    }
});

Example 3: Display a Custom Message Based on Conditions
// Show a message when the due date exceeds 30 days
frappe.ui.form.on('Purchase Order', {
    refresh: function(frm) {
        const due_date = frm.doc.due_date;
        const today = frappe.datetime.nowdate();
        
        if (frappe.datetime.get_diff(due_date, today) > 30) {
            frappe.msgprint(__('The due date exceeds 30 days.'));
        }
    }
});
### 4. **Conclusion**

#### Best Practices:

-   **Keep scripts simple and maintainable**.
-   **Use existing Frappe framework APIs** rather than writing custom code from scratch.
-   **Avoid blocking the main thread** with complex or long-running operations.

#### Debugging Client Scripts:

-   Use browser **Developer Tools** (Console) to check for errors or log output.
-   Use `console.log()` statements for debugging.
<!--stackedit_data:
eyJoaXN0b3J5IjpbMTM3MTcxOTM5OSwxMDg0NDMzNDIxLDI3Mz
ExNzY3MywtMTIyNzcxNzc3MiwxMTQ5MDMxODMyLC02NzUwMDY4
NzYsNTIzODQxMjM4LDczMDk5ODExNl19
-->